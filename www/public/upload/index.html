<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="../index.css">
	<meta charset='utf-8'>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>


	<title>emddisco</title>
</head>
<body>
	<div id='cssmenu'>
		<ul>
			<li> <a href='../index.html'><span>Home</span></a></li>
			<li class='active'><a href='#'><span>Upload</span></a></li>
		</ul>
	</div>
	<div id="container">
		<div id="content">
			<div id="uploads"></div>
			<div class="dropzone" id="dropzone" style="padding-right: 10%; padding-left: 10%">
				<h1>Drop files here to upload</h1>
			</div>
		</div>
	</div>

	<script>
	(function() {
		var dropzone = document.getElementById('dropzone');

		var displayUploads = function(data) {
			localStorage.setItem('lists', data);
			document.getElementById('dropzone').innerHTML = "<h1><a href='./results/index.html'>Results</a></h1>";
		}

		var upload = function(files) {
			var formData = new FormData(),
			xhr = new XMLHttpRequest(),
			x;

			for (x = 0; x < files.length; x++) {
				formData.append('file[]', files[x]);
			};

			xhr.onload = function() {
				var data = this.responseText;
				displayUploads(data);
				return false;
			}

			xhr.open('post', '/upload');

			xhr.send(formData);

			return false;
		};

		dropzone.ondrop = function(ev) {
			ev.preventDefault();
			this.className = 'dropzone';

			upload(ev.dataTransfer.files);
			return false;
		};

		dropzone.ondragover = function() {
			this.className = 'dropzone dragover';
			return false;
		};

		dropzone.ondragleave = function() {
			this.className = 'dropzone';
			return false;
		};
	}());
	</script>

</body>
</html>